---
// src/components/Hero.astro
import slide1 from '../assets/slphoto1.webp';
import slide2 from '../assets/slphoto2.webp';
import slide3 from '../assets/slphoto3.webp';
import slide4 from '../assets/slphoto4.webp';
import slide5 from '../assets/slphoto5.webp';
import slide6 from '../assets/slphoto6.webp'; // Assuming you have 6 now

// CRITICAL STEP: We add slide1 again at the end to create the "Infinite Loop" illusion
const slides = [slide1, slide2, slide3, slide4, slide5, slide6, slide1];
---

<section class="relative w-full h-screen overflow-hidden group">
  
  <div 
    id="slider-track" 
    class="flex w-full h-full"
  >
    {slides.map((slide, index) => (
      <div class="w-full h-full flex-shrink-0 relative">
        <img 
          src={slide.src} 
          alt={`Slide ${index + 1}`} 
          class="w-full h-full object-cover"
          loading={index === 0 ? "eager" : "lazy"} 
        />
        <div class="absolute inset-0 bg-black/40"></div>
      </div>
    ))}
  </div>

  <div class="absolute inset-0 z-10 flex items-end justify-center text-center pointer-events-none pb-10 md:pb-16">
    
    <div class="container mx-auto px-4 pointer-events-auto">
        


    </div>
  </div>

</section>

<script>
  const track = document.getElementById('slider-track');
  
  // We have 6 real slides, but the array has 7 items (6 + 1 clone)
  const realSlideCount = 6; 
  let currentIndex = 0;
  let isTransitioning = false;

  function nextSlide() {
    if (!track || isTransitioning) return;

    isTransitioning = true;
    currentIndex++;

    // 1. Enable smooth sliding
    track.style.transition = 'transform 1000ms ease-in-out';
    track.style.transform = `translateX(-${currentIndex * 100}%)`;

    // 2. Check if we hit the "Clone" (The fake first slide at the end)
    if (currentIndex === realSlideCount) {
      
      // Wait for the animation to finish (1000ms), then instantly reset
      setTimeout(() => {
        // Disable animation briefly
        track.style.transition = 'none';
        
        // Jump back to the REAL first slide (Index 0)
        currentIndex = 0;
        track.style.transform = `translateX(0%)`;
        
        // Allow clicking again
        isTransitioning = false;
      }, 1000); // This matches the CSS transition time

    } else {
      // If it's a normal slide, just unlock immediately after move
      setTimeout(() => {
        isTransitioning = false;
      }, 1000);
    }
  }

  // Auto Slide every 4 seconds
  setInterval(nextSlide, 5000);

</script>