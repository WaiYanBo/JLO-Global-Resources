---
// src/components/Navbar.astro
import logo from '../assets/logo.webp';

// ðŸ‘‡ UPDATED: Products links now point to the new page sections
const navLinks = [
  { name: "Company", href: "/company" },
  { 
    name: "Products", 
    href: "/products", // Main link goes to top of products page
    hasDropdown: true,
    subItems: [
        { name: "Daging Minang Rendang", href: "/products#rendang" },
        { name: "Vanilla Butter Cake", href: "/products#cake" },
        { name: "Lagenda Acar Buah", href: "/products#acar" }
    ]
  },
  { 
    name: "Services", 
    href: "/#services", // Anchored to home page
    hasDropdown: true,
    subItems: [
        { name: "Web Development", href: "/#services" },
        { name: "SEO Optimization", href: "/#services" },
        { name: "Consulting", href: "/#services" }
    ]
  },
  { name: "Success Story", href: "/success-story" },
  { name: "Contact Us", href: "/contact" },
];
---

<header 
  id="navbar" 
  class="fixed top-0 left-0 w-full z-50 transition-all duration-300 ease-in-out border-b border-transparent"
>
  <nav class="container mx-auto px-4 py-4 flex items-center justify-between">
    
    <a href="/" class="block">
      <img 
        src={logo.src} 
        alt="JLO Global Resources" 
        class="h-12 w-auto object-contain" 
      />
    </a>

    <ul class="hidden md:flex space-x-8 items-center">
      {navLinks.map((link) => (
        <li class="relative group">
          <a 
            href={link.href} 
            class="text-gray-200 hover:text-white transition-colors py-2 font-medium flex items-center"
          >
            {link.name}
            {link.hasDropdown && (
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            )}
          </a>

          {link.hasDropdown && (
            <div class="absolute left-0 mt-2 w-64 bg-[#00221a]/95 backdrop-blur-md border border-[#00664e]/30 rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform group-hover:translate-y-0 translate-y-2">
              {link.subItems?.map((subItem) => (
                  <a href={subItem.href} class="block px-4 py-3 text-sm text-gray-300 hover:bg-[#00664e]/40 hover:text-white transition-colors">
                    {subItem.name}
                  </a>
              ))}
            </div>
          )}
        </li>
      ))}
    </ul>

    <button id="mobile-menu-btn" class="md:hidden text-white focus:outline-none">
      <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
      </svg>
    </button>

  </nav>

  <div id="mobile-menu" class="hidden md:hidden bg-[#00221a]/98 backdrop-blur-md border-t border-[#00664e]/30 absolute w-full left-0 top-full h-screen overflow-y-auto pb-20">
    <div class="flex flex-col p-4 space-y-4">
      <a href="/company" class="text-gray-300 hover:text-white text-lg">Company</a>
      
      <div class="space-y-2">
        <span class="text-white font-bold text-lg">Products</span>
        <div class="pl-4 border-l-2 border-[#00664e] flex flex-col space-y-2 mt-2">
            <a href="/products#rendang" class="text-gray-400 hover:text-white">Daging Minang Rendang</a>
            <a href="/products#cake" class="text-gray-400 hover:text-white">Vanilla Butter Cake</a>
            <a href="/products#acar" class="text-gray-400 hover:text-white">Lagenda Acar Buah</a>
        </div>
      </div>

      <a href="/#services" class="text-gray-300 hover:text-white text-lg">Services</a>
      <a href="/success-story" class="text-gray-300 hover:text-white text-lg">Success Story</a>
      <a href="/contact" class="text-gray-300 hover:text-white text-lg">Contact Us</a>
    </div>
  </div>
</header>

<script>
  const navbar = document.getElementById('navbar');
  const mobileMenuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');

  const solidClasses = ['bg-[#00221a]/90', 'backdrop-blur-md', 'border-[#00664e]/30', 'shadow-lg'];

  function handleScroll() {
    if (!navbar) return;
    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
    if (scrollTop < 10) {
      navbar.classList.remove(...solidClasses);
    } else {
      navbar.classList.add(...solidClasses);
    }
  }

  window.addEventListener('scroll', handleScroll);

  if (mobileMenuBtn && mobileMenu) {
    mobileMenuBtn.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
        if (!mobileMenu.classList.contains('hidden')) {
            navbar?.classList.add(...solidClasses);
        } else {
            handleScroll();
        }
    });
  }
</script>